
# Chapter 3: Generalized linear models (GLMs)

**νκ·€μ™€ λ¶„λ¥ μμ  λ‘ κ°€μ§€ λ¨λ‘ Generalized Linear Models (GLMs)λΌκ³  λ¶λ¦¬λ” λ¨λΈ κ³„μ—΄μ νΉμν• κ²½μ°!!**

- **νκ·€ μμ **μ—μ„λ” μΆ…μ† λ³€μκ°€ λ…λ¦½ λ³€μμ™€ λ§¤κ° λ³€μμ— λ€ν•΄ μ •κ· λ¶„ν¬ $\mathcal{N}(\mu, \sigma^2)$ λ¥Ό λ”°λ¦„
- **λ¶„λ¥ μμ **μ—μ„λ” μΆ…μ† λ³€μκ°€ λ² λ¥΄λ„μ΄ λ¶„ν¬ $Bernoulli(\phi)$λ¥Ό λ”°λ¦„

GLM familyμ λ‹¤λ¥Έ λ¨λΈλ“¤μ΄ μ–΄λ–»κ² μ λ„λκ³  λ‹¤λ¥Έ λ¶„λ¥ λ° νκ·€ λ¬Έμ μ— μ μ©λ  μ μλ”μ§€?

## 3.1 The exponential family

---

$$ p(y; \eta) = b(y)exp(\eta^TT(y)-a(\eta))

$$

μ–΄λ– ν• PDFκ°€ μ„μ ν•μ‹μ„ μ§€μ›ν•λ‹¤λ©΄ exponential familyμ— ν•΄λ‹Ήν•¨.

- $\eta$ λ¥Ό natural parameterλΌκ³  ν•¨. κ²°λ΅ μ μΌλ΅, ν†µκ³„λ‰μ΄λ‘ λ¨λΈ νλΌλ―Έν„°λ¥Ό μ΄μ–΄μ£Όλ” μ¤‘κ°„ λ‹¨κ³„λΌκ³  λ³΄λ©΄ λ¨.
- $T(y)$λ¥Ό μ¶©λ¶„ ν†µκ³„λ‰μ΄λΌκ³  ν•¨. parameterλ¥Ό λ§μ΄ ν‘ν„ν•κ³  μ‹¶μΌλ©΄ μ¶©λ¶„ ν†µκ³„λ‰μ΄ λ§μ•„μ•Όν•¨. (νΈμμƒ $T(y) = y$λ΅ μ„¤μ •)
- $a(\eta)$λ” log partition functionμ΄λΌκ³  ν•¨. μ •κ·ν™” termμ„. ν•¨μμ— λ€ν• λ¨λ“  μ •λ³΄ ν•¨μ λμ–΄ μμ–΄μ„ λ§¤μ° μ¤‘μ”ν•¨.

κ·Έλ¦¬κ³  κ° functionλ“¤μ— λ€ν• ν¬κΈ° μ •λ³΄λ” λ‹¤μκ³Ό κ°™μ

- $y, a(\eta), b(y)$λ” μ¤μΉΌλΌ
- $\eta, T(y)$λ” λ™μΌν• μ°¨μ›
    - λ”°λΌμ„ $\eta^TT(y)$λ” μ„ ν• ν‘ν„μ„μ„ μ£Όμν•μ‹κΈΈ!

### ex_1 λ² λ¥΄λ„μ΄ λ¶„ν¬

![https://i.imgur.com/Ulptc8k.png](https://i.imgur.com/Ulptc8k.png)

$$ \begin{aligned} &\eta = \log(\frac{\Phi}{(1-\Phi)}) \\ &\Phi = \frac{1}{1+e^{-\eta}} \end{aligned} $$

- λ² λ¥΄λ„μ΄ λ¶„ν¬λ¥Ό λ‹¤μκ³Ό κ°™μ΄ λ§¤ν•‘ν•λ‹¤λ©΄, ν•™μµ λ° μ¶”λ΅ μ΄ λ”μ± μ‰¬μ›μ§.
    - ν†µκ³„λ‰μ— λ€ν•΄μ„λ” μµμ ν™”ν•κΈ° μ–΄λ µμ§€λ§, $\eta$ μ€ SGDλ¥Ό ν†µν•΄ μµμ ν™”ν•  μ μμ–΄μ„...!

λ‚λ¨Έμ§€ λ§¤ν•‘λλ” functionμ€ λ‹¤μκ³Ό κ°™μ.

![https://i.imgur.com/wjOnxlL.png](https://i.imgur.com/wjOnxlL.png)

μ—¬κΈ°μ„ μ°λ¦¬κ°€ μ¤‘μ”ν•κ² λ΄μ•Όν•  κ²ƒμ€ log partition functionμ„.

- $1+exp(\eta)$ λ¥Ό λ³΄μλ©΄, κΈ/λ¶€μ • μƒν”λ΅ μΈμ½”λ”©ν•λ” μ—­ν• μ„ μν–‰ν•¨
- $log(1+exp(\eta))$ λ¥Ό λ―Έλ¶„ν•λ‹¤λ©΄, μ‹¤μ λ΅ $y$μ κΈ°λ“κ°’μ— ν•΄λ‹Ήν•¨.

### ex_2 κ°€μ°μ‹μ• λ¶„ν¬

![https://i.imgur.com/np3480A.png](https://i.imgur.com/np3480A.png)

![https://i.imgur.com/vbwgBSZ.png](https://i.imgur.com/vbwgBSZ.png)

κ·Έλμ„ μ§€μ μ΅±μ΄λΌλ©΄ λ­κ°€ μΆ‹μ€κ°€?

- μ¶”λ΅ μ΄ μ‰¬μ›μ§.
    - λ΅κ·Έ λ¶„ν•  ν•¨μλ¥Ό λ―Έλ¶„ν•λ©΄ yκ°’μ— λ€ν• κΈ°λ“κ°’μ„ κµ¬ν•  μ μλ‹¤κ³  ν–μ.
    - μ΄λ¬λ©΄ ν‰κ· κ³Ό λ¶„μ‚°μ„ κµ¬ν•κΈ°κ°€ μ‰¬μ›μ§
- ν•™μµμ— μ μ μ©ν•  μ μμ
    - νλΌλ―Έν„°κ°€ concaveν•κΈ° λ•λ¬Έμ— ν•™μµν•κΈ° μ‰¬μ΄ λ°©ν–¥μ„/
    - λ”°λΌμ„ NLLμ—μ„λ” νλΌλ―Έν„°κ°€ λ³Όλ΅ν•¨

## 3.2 Constructing GLMs

---

GLMμ„ μ„ν•΄μ„λ” μ•„λμ— μ„Έ κ°€μ§€ κ°€μ •μ΄ ν•„μ”ν•λ‹¤.

1. $y | x; \theta \sim \text{ExponentialFamily}(\eta)$,

- μ£Όμ–΄μ§„ $x$μ™€ $\theta$ μ— λ€ν•΄, $y$ μ λ¶„ν¬λ” νλΌλ―Έν„° $\eta$λ¥Ό κ°€μ§„ μ–΄λ–¤ μ§€μμ΅± λ¶„ν¬λ¥Ό λ”°λ¥Έλ‹¤.

1. **$T(y)$ μ κΈ°λ€κ°’ μμΈ΅ν•λ” κ²ƒμ΄ λ©ν‘**

- μ‰¬μ΄ μ ‘κ·Όμ„ μ„ν•΄ $T(y) = y$ μΌλ΅ κ°€μ • (λ³„λ„μ λ°μ΄ν„° μ „μ²λ¦¬ κ³Όμ • X)
- μ΄λ¥Ό ν†µν•΄ ν•™μµλ κ°€μ„¤μ— μν•΄ μ¶λ ¥λ μμΈ΅μ΄ $\mathbb{E}[y | x]$μ™€ μΌμΉν•λ„λ΅ ν•κ³ μ ν•λ‹¤.
    - λ΅μ§€μ¤ν‹± νκ·€μ—μ„λ” $\mathbb{E}[y | x]$ κ°€ $y = 1$ μΌ ν™•λ¥ μ„ μμΈ΅ν•λ©°, μ΄λ” μ¶λ ¥ κ°€μ„¤ $h_\theta(x)$μ™€ λ™μΌ

1. **μμ—° νλΌλ―Έν„° $\eta$ μ™€ μ…λ ¥ $x$ λ” μ„ ν• κ΄€κ³„**

$$ β $$

**μµμ μ $\theta$λ¥Ό μ„ νƒν•λ” κ²ƒμ€ μµμ μ μμ—° νλΌλ―Έν„° $\eta$λ¥Ό μ„ νƒν•λ” κ²ƒκ³Ό κ°™μ**

- $\eta$ λ” $\theta$ μ™€ μ…λ ¥ $x$ μ μ„ ν• κ²°ν•©μΌλ΅ ν‘ν„ β†’ μµμ μ $\theta$ λ¥Ό κµ¬ν•λ” κ²ƒμ΄ κ³§ λ°μ΄ν„°λ¥Ό μ μ„¤λ…ν•λ” μµμ μ μμ—° νλΌλ―Έν„° $\eta$ λ¥Ό κµ¬ν•λ” κ³Όμ •κ³Ό μΌμΉ

νλΌλ―Έν„° ν•™μµμ€ λ‹¤μκ³Ό κ°™λ‹¤

- λ¨λ“  μ§€μ λ¶„ν¬μ΅± λ¨λΈμ—μ„λ„ λ‹¤μκ³Ό κ°™μ€ ν•νƒμ„μ„ ν™•μΈλμ—λ‹¤κ³  ν•λ‹¤.
- μ΄λ” **λ΅μ§€μ¤ν‹± νκ·€**μ™€ κ°™μ€ λ‹¤λ¥Έ λ¨λΈμ—μ„λ„ λΉ„μ·ν• ν•νƒλ¥Ό κ°€μ§„λ‹¤.

$$ \theta_j := \theta_j + \alpha (y^{(i)} - h_\theta(x^{(i)}))x_j^{(i)}

$$

λ‹¤μμ€ GLMμ μ „λ°μ μΈ λ‹¤μ΄μ–΄κ·Έλ¨μ΄λ‹¤.

![https://i.imgur.com/Wk7VeEo.png](https://i.imgur.com/Wk7VeEo.png)

**Exponential Familyλ” μμ—° νλΌλ―Έν„° π‚ Ξ·μ™€ λ¶„ν¬μ ν†µκ³„λ‰ $(\mathbb{E}[y \mid x])$ μ„ μ—°κ²°ν•΄μ£Όλ” Linking μ—­ν• **

1. **μ„ ν• λ¨λΈ**

- μ…λ ¥ λ°μ΄ν„° $x$λ” μ„ ν• λ¨λΈλ΅ λ“¤μ–΄κ°€λ©°, μ—¬κΈ°μ„ μ„ ν• κ²°ν•© $\theta^T x$κ°€ κ³„μ‚°λλ‹¤.
- μ…λ ¥ λ³€μλ“¤κ³Ό νλΌλ―Έν„°μ μ„ ν• κ²°ν•©μΌλ΅ μμ—° νλΌλ―Έν„° $\eta$λ¥Ό κ³„μ‚°ν•λ„λ΅ ν•λ‹¤.

1. **Exponential Family**

- μ„ ν• κ²°ν•©λ¥Ό ν†µν•΄ κ³„μ‚°λ κ°’μ€ μμ—° νλΌλ―Έν„°λ΅μ„, μ§€μμ΅± λ¶„ν¬μ λ¨ν•μ— μ‚¬μ©λλ‹¤.
- $\eta$ λ” μ§€μμ΅± λ¶„ν¬μ—μ„ κΈ°λ€κ°’μ„ κ³„μ‚°ν•λ” λ° μ‚¬μ©

1. **μµλ€ν™” λ¬Έμ **

- μ£Όμ–΄μ§„ λ°μ΄ν„°μ— λ€ν•΄ $y$κ°€ $\theta$ μ— μν•΄ μ μ„¤λ…λ  μ μλ„λ΅ μµμ μ $\theta$ λ¥Ό μ°Ύλ„λ΅ ν•¨.

$$ \max_\theta \log p(y | \theta^T x^{(i)}) $$

1. **μμΈ΅ κ³Όμ •**

- μ£Όμ–΄μ§„ μ…λ ¥μ— λ€ν•΄ $y$ μ κΈ°λ€κ°’μ„ μμΈ΅

$$ \mathbb{E}[y ; \eta] = \mathbb{E}[y ; \theta^T x] = h_\theta(x) $$

### 3.2.3 Softmax regression

**Softmax ν•¨μλ” $K$κ°μ ν΄λμ¤ μ¤‘ ν•λ‚μ— μ†ν•  ν™•λ¥ μ„ λ¨λΈλ§ν•λ” ν•¨μ**

- μΆ…μ† λ³€μ yκ°€ k κ°’ μ¤‘ ν•λ‚λ¥Ό μ·¨ν•  μ μλ” λ¶„λ¥ λ¬Έμ  $y \in (1, 2, \dots, k)$λ¥Ό μƒκ°ν•΄λ³΄μ.
- μ§€μμ΅± λ¶„ν¬λ΅ multinomialμ„ ν‘ν„ν•κΈ° μ„ν•΄ $\mathbb{R}^{k-1}$μ—μ„ $T(y)$λ¥Ό λ‹¤μκ³Ό κ°™μ΄ μ •μν•λ‹¤.

$$ \begin{aligned} &T(1) = \begin{bmatrix} 1 \\ 0 \\ 0 \\ \vdots \\ 0 \end{bmatrix}, \quad T(2) = \begin{bmatrix} 0 \\ 1 \\ 0 \\ \vdots \\ 0 \end{bmatrix}, \quad T(3) = \begin{bmatrix} 0 \\ 0 \\ 1 \\ \vdots \\ 0 \end{bmatrix}, \quad \cdots \\ &,T(k-1) = \begin{bmatrix} 0 \\ 0 \\ 0 \\ \vdots \\ 1 \end{bmatrix}, \quad T(k) = \begin{bmatrix} 0 \\ 0 \\ 0 \\ \vdots \\ 0 \end{bmatrix} \end{aligned} $$

μ΄λ¥Ό κΈ°ν•μ μΌλ΅ ν‘ν„ν•κΈ° μ‰½κ²λ” ν‘ν„ν•λ‹¤λ©΄β€¦

![https://i.imgur.com/exiloB8.png](https://i.imgur.com/exiloB8.png)

**Multinomal distribution λν• μ§€μμ΅± λ¶„ν¬μ— ν•΄λ‹Ήν•λ‹¤.**

- μ΄λ¥Ό ν†µν•΄μ„ μμ—° νλΌλ―Έν„° $\eta$λ¥Ό μ „κ°ν•λ„λ΅ ν•λ‹¤λ©΄ λ‹¤μκ³Ό κ°™λ‹¤.

![https://i.imgur.com/J3QRx7u.png](https://i.imgur.com/J3QRx7u.png)

μ§€μ λ¶„ν¬μ΅±μ κµ¬μ΅°λ¥Ό ν†µν•΄ μμ—° νλΌλ―Έν„°μ™€ **ν†µκ³„λ‰** κ°„μ κ΄€κ³„λ¥Ό λ‚νƒ€λ‚΄λ” μ‹μ€ λ‹¤μκ³Ό κ°™λ‹¤.

$$ \phi_i = \phi_k e^{\eta_i} = \frac{e^{\eta_i}}{\sum^k_{j=1}e^{\eta_j}} $$

- μ΄ κ΄€κ³„λ¥Ό μ†ν”„νΈλ§¥μ¤ ν™•λ¥  λ¨λΈ λΌκ³  λ¶€λ¥Έλ‹¤.
- μμ—° νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•μ—¬ λ‹¤μ¤‘ ν΄λμ¤ λ¶„λ¥ λ¬Έμ μ—μ„ κ° ν΄λμ¤μ— λ€ν• ν™•λ¥ μ„ κ³„μ‚°ν•λ” λ° μ‚¬μ©
- μ§€μμ΅± λ¶„ν¬μ—μ„ μμ—° νλΌλ―Έν„°κ°€ ν™•λ¥ μ„ κ²°μ •ν•λ” ν•µμ‹¬μ μΈ μ—­ν• 

μ£Όμ–΄μ§„ μ…λ ¥ $x$μ— λ€ν•΄ κ° ν΄λμ¤ $k$μ ν™•λ¥ μ€ λ‹¤μκ³Ό κ°™μ΄ κ³„μ‚°λλ‹¤.

$$ p(y = k | x) = \frac{\exp(\eta_k)}{\sum_{j=1}^{K} \exp(\eta_j)} = \frac{\exp(\theta_k^T x)}{\sum_{j=1}^{K} \exp(\theta_j^T x)} $$

**$\eta_k = \theta_k^T x$ λ” ν΄λμ¤ $k$ μ— ν•΄λ‹Ήν•λ” μμ—° νλΌλ―Έν„°μ΄λ‹¤.**

- μ…λ ¥ $x$ μ™€ νλΌλ―Έν„° $\theta_k$ μ μ„ ν• κ²°ν•©μΌλ΅ μ΄λ¤„μ§„λ‹¤.
- $\exp(\eta_k)$ λ” ν΄λμ¤ $k$ μ **μ§€μ ν•¨μ**λ¥Ό μ·¨ν• κ°’μ΄λ©°, μ΄λ¥Ό λ‹¤λ¥Έ ν΄λμ¤λ“¤μ μ§€μ ν•¨μ κ°’λ“¤μ ν•©μΌλ΅ λ‚λ„μ–΄ ν™•λ¥ μ„ κ³„μ‚°

$$ \begin{aligned} h_\theta(x) &= \mathbb{E}[T(y) | x; \theta] \\ &= \mathbb{E}\left[ \begin{pmatrix} 1\{y = 1\} \\ 1\{y = 2\} \\ \vdots \\ 1\{y = k-1\} \end{pmatrix} \Bigg| x; \theta \right] \\ &= \begin{pmatrix} \phi_1 \\ \phi_2 \\ \vdots \\ \phi_{k-1} \end{pmatrix} \\ &= \begin{pmatrix} \frac{\exp(\theta_1^T x)}{\sum_{j=1}^{k} \exp(\theta_j^T x)} \\ \frac{\exp(\theta_2^T x)}{\sum_{j=1}^{k} \exp(\theta_j^T x)} \\ \vdots \\ \frac{\exp(\theta_{k-1}^T x)}{\sum_{j=1}^{k} \exp(\theta_j^T x)} \end{pmatrix} \end{aligned} $$

μ΄ κ²½μ°μ—λ” Cross-entropyλ¥Ό μµμ†ν™”ν•λ” λ°©ν–¥μΌλ΅ ν•™μµμ„ ν•κ² λ¨

$$ \min \text{Cross-entropy}(p,\hat{p})=-\sum^k_{y=1}p(y)log(\hat{p}(y)) $$

Cross-entropyμ— λ€ν•΄μ„λ” Decision tree ννΈλ¥Ό ν†µν•΄μ„ λ””ν…μΌν•κ² μ„¤λ…ν•λ„λ΅ ν•λ‹¤.